# NX Agent AI Security Guard Plugin

A powerful AI-powered security monitoring system for Network Optix Nx Meta VMS. The plugin analyzes video metadata to detect anomalies and unusual conditions, bringing important security events to the forefront.

## Features

- **Real-time Metadata Analysis**: Analyze video metadata from camera feeds to detect objects, motion patterns, and activities.
- **Anomaly Detection**: Automatically learn normal patterns and detect deviations using statistical modeling and machine learning.
- **Persistent Unknown Visitor Detection**: Identify and track unknown individuals who remain in a scene for extended periods.
- **Suspicious Activity Recognition**: Detect unusual motion patterns, loitering in restricted areas, and other abnormal behaviors.
- **VMS UI Integration**: Seamlessly integrate with Nx Meta's interface to display alerts and camera feeds when anomalies are detected.
- **Automated Response Protocols**: Execute site-specific Standard Operating Procedures (SOPs) when threats are detected.
- **Continuous Learning**: Adapt to the environment over time by learning normal behaviors and refining anomaly detection.

## System Requirements

- Network Optix Nx Meta VMS 5.0 or higher
- 64-bit Linux (Ubuntu 18.04/20.04 LTS recommended) or Windows 10/11/Server
- 4GB RAM minimum (8GB+ recommended)
- x86-64 CPU with SSE4.2 support
- OpenCV 4.2+ and its dependencies
- 50MB free disk space for plugin, plus storage for models and configuration

## Installation

### Pre-built Binaries

1. Download the latest release package for your operating system from the [Releases](https://github.com/nx-agent/nx-agent-plugin/releases) page.
2. Extract the package contents to a temporary location.
3. Copy the plugin library (`nx_agent_plugin.so` for Linux or `nx_agent_plugin.dll` for Windows) to the Nx Meta plugins directory:
   - Linux: `/opt/networkoptix-metavms/mediaserver/bin/plugins/`
   - Windows: `C:\Program Files\Network Optix\Nx Meta\bin\plugins\`
4. Restart the Nx Meta Server service:
   - Linux: `sudo systemctl restart networkoptix-metavms`
   - Windows: Use Services management console to restart "Nx Meta Server"

### Building from Source

#### Linux

```bash
# Install dependencies
sudo apt-get update
sudo apt-get install -y build-essential cmake libopencv-dev nlohmann-json3-dev

# Clone repository
git clone https://github.com/nx-agent/nx-agent-plugin.git
cd nx-agent-plugin

# Create build directory
mkdir build
cd build

# Configure and build
cmake ..
make -j4

# Install
sudo make install
```

#### Windows

1. Install Visual Studio 2019 or later with C++ development tools
2. Install CMake 3.15 or higher
3. Install OpenCV 4.2+ using vcpkg or pre-built binaries
4. Install nlohmann-json using vcpkg
5. Open the project in Visual Studio and build the solution
6. Copy the built DLL to the Nx Meta plugins directory

## Configuration

### Enabling the Plugin

1. Open Nx Meta Desktop Client and log in as an administrator
2. Go to **Server Settings** > **Plugins**
3. Find "NX Agent AI Security Guard" in the list and click the checkbox to enable it
4. Click **Apply** to save changes

### Camera Configuration

1. Select a camera in the Resource Tree
2. Go to the **Camera Settings** tab
3. Open the **Analytics** section
4. Check "NX Agent AI Security Guard" to enable the plugin for this camera
5. Configure the plugin settings:
   - **Sensitivity Level**: Adjust how sensitive the system is to anomalies (0.0-1.0)
   - **Learning Mode**: Enable/disable automatic learning of normal patterns
   - **Detection Regions**: Draw regions of interest to focus monitoring on specific areas
   - **Business Hours**: Set normal operational hours for your site
   - **Unknown Visitor Threshold**: Time in seconds before an unknown visitor is considered suspicious

### Response Configuration

1. Go to **Event Rules** in Nx Meta Desktop Client
2. Create a new rule for the events generated by the plugin:
   - **Event**: Select "Analytics Event" > "NX Agent AI Security Guard" > choose event type
   - **Action**: Configure desired response (e.g., "Show on Alarm Layout", "Send Email", etc.)
   - **Schedule**: Set when this rule should be active

## Usage

### Learning Phase

When first enabled on a camera, the plugin enters a learning phase to establish normal patterns. During this time:

- The plugin collects data about typical activity patterns
- No anomaly alerts will be generated
- A status event "Learning in Progress" will be shown

The learning phase typically lasts 8-12 hours but can be extended for more complex environments. Once complete, the plugin automatically switches to detection mode.

### Detection Mode

In detection mode, the plugin:

- Analyzes all video frames for anomalies
- Generates events when unusual activity is detected
- Continues to refine its model if continuous learning is enabled

### Events and Alerts

The plugin generates several types of events:

- **Anomaly Detected**: General unusual activity that deviates from normal patterns
- **Unknown Visitor**: An unrecognized person lingering in the scene
- **Abnormal Activity**: Specific suspicious activities like loitering in restricted areas
- **Status Events**: Plugin status updates like "Learning Complete"

### Viewing Alerts

When an anomaly is detected:

1. The camera will appear in the Alarm Layout (if configured in Event Rules)
2. The detected object will be highlighted with a bounding box
3. Event details will be available in the Nx Meta event log
4. Automated responses will be triggered according to your rules

## Support and Feedback

For support, bug reports, or feature requests, please:

- Create an issue on our [GitHub repository](https://github.com/nx-agent/nx-agent-plugin/issues)
- Contact us at support@nx-agent.com

## License

This plugin is licensed under the [MIT License](LICENSE).
